<html lang="en">

<head>
  <title>Select the restaurant of your dreams</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script type="text/javascript" src="https://code.jquery.com/ui/1.11.0/jquery-ui.min.js"></script>
	<link rel="stylesheet" media="all" type="text/css" href="https://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css" />

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.js"></script>
  <link rel="stylesheet" media="all" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.css" />

  <h2>Select the restaurant of your dreams...</h2>

  
  <script>
  "use strict";
  $(
    function() {
     var datepicker = $( "#datepicker_id" );
     var restaurant_time_ranges; // propagated later
     datepicker.datetimepicker( {
       stepMinute: 15,
       onSelect: function (selectedDateTime){
         // if they change day or anything this is triggered (i.e. even early)...
          var date = datepicker.datetimepicker('getDate');
          new_date_input_selected(date);
         }
     });
     
     $.getJSON("rest_hours.json", function(data){
       restaurant_time_ranges = parse_all_restaurants(data);
     });
    }
   );
   
   function parse_all_restaurants(data) {
     // data is ["name": "Bai Thong Thai Cuisine", "times": ["Mon-Sat 11 am - 11 pm", "Sun 11 am - 10 pm"] ...]
     // desired output: [ranges: [[day_of_week, start_minute, end_minute], ... ]
     var output = [];
     for(var i=0; i < data.length; i++){
       output.push(parse_single_restaurant_to_ranges(data[i]));
     }
   
     // TODO add divs for them
   }
   
   function parse_single_restaurant_to_ranges(restaurant) {
     var output = [];
     var times = restaurant.times;
     for(var i=0; i < times.length; i++){
       var time_range = times[i];
       output.push(parse_single_range(time_range)); // XXXX can it push on multiples?
     }
   }
   
   function parse_single_range(time_range) {
      // time: like "Mon-Sat 11 am - 11 pm" "Sun 11 am - 10:30 pm"
   }
   
   function string_week_day_to_int(day) {
     return ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"].indexOf(day); // javascript doesn't seem to have a lightweight way to do this :|
   }
   
   function new_date_input_selected(date) {
     var day_of_week = date.getDay(); // day of the week (0 is sunday)
     // TODO ...
   }
   
   function assert_range_parses(time_range, expected) {
     var parsed = parse_single_range(time_range);
     console.assert(parsed == expected, {"message": "parsed wrong", "parsed": parsed, "expected": expected});
   }
   
   function do_unit_tests() {
     //assert_range_parses("Mon 11 am - 11 pm", [)
   }
   
   do_unit_tests();
   
  </script>

  <p>Date: <input type="text" id="datepicker_id"></p>


</body>

</html>